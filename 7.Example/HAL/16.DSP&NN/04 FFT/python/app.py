import numpy as np
import matplotlib.pyplot as plt
from scipy import fftpack

src = [  # len = 128
    1.600000, 1.861532, 2.102299, 2.303861, 2.452154, 2.539036, 2.563148, 2.529988, 2.451189, 2.343098, 2.224810, 2.115892, 2.034071, 1.993147, 2.001377, 2.060527, 2.165685, 2.305883, 2.465421, 2.625765, 2.767782, 2.874053, 2.930986, 2.930493, 2.871014, 2.757789, 2.602321, 2.421111, 2.233799, 2.060928, 1.921597, 1.831270, 1.800000, 1.831270, 1.921597, 2.060928, 2.233799, 2.421112, 2.602321, 2.757789, 2.871014, 2.930493, 2.930986, 2.874053, 2.767782, 2.625765, 2.465421, 2.305883, 2.165685, 2.060527, 2.001377, 1.993147, 2.034071, 2.115892, 2.224810, 2.343099, 2.451189, 2.529989, 2.563148, 2.539036, 2.452154, 2.303861, 2.102299, 1.861531, 1.600000, 1.338468, 1.097701, 0.896139, 0.747847, 0.660964, 0.636852, 0.670012, 0.748811, 0.856902, 0.975192, 1.084109, 1.165929, 1.206853, 1.198623, 1.139473, 1.034314, 0.894117, 0.734579, 0.574234, 0.432218, 0.325947, 0.269014, 0.269507, 0.328986, 0.442212, 0.597680, 0.778890, 0.966201, 1.139072, 1.278404, 1.368730, 1.400000, 1.368729, 1.278403, 1.139070, 0.966201, 0.778887, 0.597678, 0.442211, 0.328986, 0.269507, 0.269014, 0.325947, 0.432218, 0.574236, 0.734581, 0.894117, 1.034315, 1.139474, 1.198623, 1.206853, 1.165929, 1.084106, 0.975190, 0.856901, 0.748808, 0.670013, 0.636851, 0.660963, 0.747846, 0.896140, 1.097702, 1.338468
]
dst = [  # len = 64
    1.600000, 1.000000, 0.000000, 0.300000, 0.000000, 0.000000, 0.000000, 0.500000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000,
]


full_size = len(src)
half_size = int(full_size / 2)
show_size = int(half_size / 4)

x = fftpack.fftfreq(full_size) * 6400  # *6400 方便观察频率
y = np.abs(fftpack.fft(src) / half_size)
y[0] = y[0] / 2  # 直流分量多除个2

x = x[:half_size]  # 截半
y = y[:half_size]

plt.figure(figsize=(8, 12))
plt.subplots_adjust(hspace=0.3)

plt.subplot(3, 1, 1)

plt.title("wave")
plt.plot(src)

plt.subplot(3, 1, 2)
plt.title("python fft")
plt.scatter(x[:show_size], y[:show_size])

plt.subplot(3, 1, 3)
plt.title("stm32 fft")
plt.scatter(x[:show_size], dst[:show_size])

plt.show()

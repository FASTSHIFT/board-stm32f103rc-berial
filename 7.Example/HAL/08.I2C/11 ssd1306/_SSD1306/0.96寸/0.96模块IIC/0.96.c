//=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

//=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

#include <at89x51.h>
//#include <reg52.h>
#include <intrins.h>

//-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
//  Pin Definition
//-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

#define BS0	P2_6				// 010--i2c   001---6800 8位  011--8080 8位   000---4 SPI   100---3SPI
#define BS1	P2_5				// 
#define BS2	P2_7				// 


#define CS	P2_0				// Reset
#define RES	P2_1				// Serial Clock Input
#define RS	P2_2				// Serial Data Input
#define WR	P2_3				// Reset
#define RD	P2_4				// Serial Clock Input
#define PORT	P0				// Serial Clock Input

#define Uchar unsigned char
#define Uint  unsigned int
#define Ulong unsigned long
#define uchar unsigned char
#define uint  unsigned int

//*********************************************************************
code 	color[]={/*--  调入了一幅图像：F:\工作\8051\OLED1\abcd.bmp  --*/
/*--  宽度x高度=128x64  --*/
0x00,0x00,0x00,0xF0,0x08,0x04,0x04,0x08,0xF0,0x00,0x04,0xFC,0x04,0x00,0x00,0x00,
0x00,0x04,0xFC,0x44,0x44,0xE4,0x0C,0x00,0x04,0xFC,0x04,0x04,0x08,0xF0,0x00,0xA8,
0xAE,0x98,0xFF,0xAC,0x8A,0x10,0xFC,0x0B,0x88,0x78,0x08,0x00,0x88,0x86,0x92,0x92,
0x92,0x92,0xD3,0xB2,0x92,0x82,0x8A,0x86,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x82,0x82,0xF2,0x92,0x97,0x92,0xFA,0x92,0x97,0xF2,
0x82,0x82,0x00,0x04,0x04,0x04,0x1C,0x64,0x85,0x06,0xC4,0x3C,0x04,0x04,0x04,0x00,
0x00,0x80,0x3E,0x2A,0xEA,0x2A,0x2A,0xEA,0x2A,0x3F,0x82,0x00,0x00,0x00,0x10,0x12,
0xD2,0x12,0x12,0xF2,0x12,0x52,0x93,0x1A,0x10,0x00,0x00,0xC0,0xC0,0x00,0x00,0x00,
0x00,0x00,0x00,0x01,0xC2,0x04,0xC4,0x02,0x81,0x40,0x44,0x47,0x84,0x04,0x04,0x06,
0x00,0x04,0x07,0x04,0x04,0x84,0xC6,0x00,0x04,0x07,0x84,0x44,0x42,0x41,0x80,0x08,
0x88,0x45,0x42,0x42,0x85,0x08,0x04,0x03,0x82,0xC4,0x08,0x00,0xC0,0x40,0x40,0x40,
0x40,0x08,0x8F,0x40,0x40,0xC0,0x00,0x00,0xC0,0x40,0x41,0xC2,0x46,0x00,0x80,0x40,
0x40,0x40,0x80,0x00,0x80,0x40,0x48,0x48,0x88,0x04,0x82,0x41,0x40,0x41,0x82,0x04,
0x08,0x08,0x00,0x08,0x08,0x08,0x44,0xC4,0x02,0x01,0x02,0x04,0x04,0x08,0x08,0x00,
0x08,0x08,0x09,0x0A,0x0F,0x48,0xC8,0x0F,0x0A,0x09,0xCC,0x08,0x00,0x04,0x42,0xC1,
0x40,0x40,0x88,0x0F,0x80,0x40,0x40,0x41,0xC6,0x00,0x40,0xC6,0x46,0x40,0x80,0x00,
0x00,0x00,0x09,0x3D,0x0B,0x3D,0x0B,0x09,0x03,0x34,0x24,0x24,0x1F,0x00,0x00,0x00,
0x21,0x00,0x00,0x00,0x00,0x20,0x3F,0x20,0x00,0x00,0x31,0x28,0x24,0x22,0x21,0x00,
0x10,0x20,0x22,0x22,0x1D,0x00,0x04,0x0B,0x08,0x3F,0x28,0x00,0x13,0x22,0x22,0x22,
0x1C,0x00,0x1F,0x22,0x22,0x22,0x1C,0x00,0x00,0x00,0x3E,0x01,0x00,0x00,0x1D,0x22,
0x22,0x22,0x1D,0x00,0x03,0x34,0x24,0x24,0x1F,0x00,0x1F,0x20,0x20,0x20,0x1F,0x00,
0x00,0x14,0x2A,0x2A,0x3C,0x20,0x00,0x3F,0x22,0x22,0x1C,0x00,0x00,0x1C,0x22,0x22,
0x26,0x00,0x00,0x1C,0x22,0x22,0x3F,0x20,0x20,0x3E,0x09,0x0F,0x38,0x20,0x20,0x3F,
0x22,0x22,0x1D,0x00,0x1F,0x20,0x20,0x20,0x10,0x00,0x20,0x3F,0x20,0x20,0x1F,0x00,
0x00,0x00,0x88,0xE8,0x9E,0xC8,0xBE,0x88,0x00,0x00,0x00,0x04,0xFE,0x00,0x00,0x00,
0x00,0xFC,0x02,0x02,0x02,0xFC,0x00,0x00,0x00,0x30,0x30,0x00,0x00,0x00,0x00,0x00,
0x04,0xFE,0x00,0x00,0x00,0x00,0x0C,0x82,0x42,0x22,0x1C,0x00,0x00,0x04,0x02,0x12,
0x12,0xEC,0x00,0x40,0xB0,0x88,0x84,0xFE,0x00,0x00,0x00,0xBE,0x12,0x12,0x12,0xE2,
0x00,0x00,0xF8,0x24,0x12,0x12,0xE6,0x00,0x00,0x20,0x90,0x50,0x50,0xE0,0x00,0x02,
0xFE,0x10,0x10,0x10,0xE0,0x00,0x00,0xE0,0x10,0x10,0x10,0x30,0x00,0x00,0xE0,0x10,
0x10,0x12,0xFE,0x00,0x00,0x80,0x78,0x46,0x78,0x80,0x00,0x02,0xFE,0x12,0x12,0x12,
0xEC,0x00,0xF8,0x04,0x02,0x02,0x02,0x06,0x00,0x02,0xFE,0x02,0x02,0x04,0xF8,0x00,
0x40,0xC0,0x78,0x43,0xC0,0x7B,0x40,0x00,0x00,0x10,0x10,0xFA,0x03,0x02,0x00,0x00,
0x00,0x71,0x0A,0x0A,0x0A,0x89,0x70,0x00,0x00,0x03,0x03,0xC0,0xC0,0x00,0x00,0x00,
0x02,0x13,0x12,0xF8,0x00,0x00,0x03,0x02,0x02,0x72,0x0A,0x08,0x08,0x89,0x72,0x02,
0x02,0x31,0x08,0x88,0x88,0x48,0x32,0x03,0x02,0x00,0xC0,0x21,0x12,0xFA,0x02,0x01,
0x00,0xF8,0x09,0x8A,0x8A,0x0A,0x09,0x00,0x00,0xE1,0x12,0x8A,0x8A,0x1B,0x02,0x00,
0x03,0x02,0x82,0x82,0x81,0x80,0x00,0x01,0x0A,0xFA,0x02,0x81,0x80,0x00,0x01,0x02,
0x02,0x02,0x03,0x82,0x82,0x83,0x02,0x00,0x02,0x03,0xC2,0x3A,0xE3,0x02,0x02,0x02,
0x09,0xF8,0x88,0x89,0x8A,0x72,0x02,0x01,0xC0,0x32,0x0B,0x0A,0x0A,0x09,0x38,0x00,
0x04,0x3F,0x04,0x04,0x3F,0x04,0x04,0x00,0x00,0x20,0x20,0x3F,0x20,0x20,0x00,0x00,
0x00,0x30,0x28,0x24,0x22,0x21,0x30,0x00,0x00,0x00,0x00,0x30,0x30,0x00,0x00,0x00,
0x00,0x20,0x20,0x3F,0x20,0x20,0x00,0x00,0x00,0x30,0x28,0x24,0x22,0x21,0x30,0x00,
0x00,0x18,0x20,0x20,0x20,0x11,0x0E,0x00,0x00,0x07,0x04,0x24,0x24,0x3F,0x24,0x00,
0x00,0x19,0x21,0x20,0x20,0x11,0x0E,0x00,0x00,0x0F,0x11,0x20,0x20,0x11,0x0E,0x00,
0x00,0x19,0x24,0x22,0x22,0x22,0x3F,0x20,0x00,0x3F,0x11,0x20,0x20,0x11,0x0E,0x00,
0x00,0x0E,0x11,0x20,0x20,0x20,0x11,0x00,0x20,0x3C,0x23,0x02,0x02,0x27,0x38,0x20,
0x20,0x3F,0x20,0x20,0x20,0x11,0x0E,0x00,0x07,0x18,0x20,0x20,0x20,0x10,0x08,0x00,
0x10,0x90,0xFE,0x10,0x10,0x90,0xFE,0x10,0x00,0x00,0x00,0x04,0x04,0xFE,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0xC0,0x30,0x08,0x04,0xFE,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x60,0x60,0x00,0x00,0x00,0x00,0x00,0x00,0x04,0x04,0xFE,0x00,0x00,0x00,0x00,
0x00,0x00,0x1C,0x02,0x02,0x02,0x02,0xC2,0x3C,0x00,0x00,0x00,0x1C,0x02,0x42,0x42,
0x62,0x9C,0x00,0x00,0x00,0x00,0x80,0x40,0x40,0x40,0x40,0x40,0x80,0x00,0x00,0x00,
0x02,0xFE,0x80,0x40,0x40,0x40,0x80,0x00,0x00,0x00,0x00,0x80,0x40,0x40,0x40,0x80,
0x00,0x00,0x00,0x00,0x00,0x80,0x78,0x06,0x78,0x80,0x00,0x00,0x00,0x00,0x02,0xFE,
0x42,0x42,0x42,0x62,0x9C,0x00,0x00,0x00,0xF0,0x08,0x04,0x02,0x02,0x02,0x04,0x0E,
0x04,0x3F,0x04,0x04,0x04,0x3F,0x04,0x04,0x00,0x00,0x00,0x20,0x20,0x3F,0x20,0x20,
0x00,0x00,0x00,0x00,0x03,0x02,0x02,0x22,0x22,0x3F,0x22,0x22,0x00,0x00,0x00,0x00,
0x00,0x30,0x30,0x00,0x00,0x00,0x00,0x00,0x00,0x20,0x20,0x3F,0x20,0x20,0x00,0x00,
0x00,0x00,0x30,0x28,0x24,0x22,0x21,0x20,0x38,0x00,0x00,0x00,0x1C,0x20,0x20,0x20,
0x20,0x10,0x0F,0x00,0x00,0x00,0x19,0x24,0x24,0x22,0x22,0x22,0x3F,0x20,0x30,0x00,
0x00,0x3F,0x10,0x20,0x20,0x20,0x10,0x0F,0x00,0x00,0x0F,0x10,0x20,0x20,0x20,0x11,
0x08,0x00,0x00,0x20,0x38,0x27,0x02,0x02,0x02,0x27,0x38,0x20,0x00,0x00,0x20,0x3F,
0x20,0x20,0x20,0x20,0x10,0x0F,0x00,0x00,0x07,0x18,0x20,0x20,0x20,0x20,0x10,0x0C

};

code 	color1[]={/*--  调入了一幅图像：F:\工作\8051\OLED1\中文显示.bmp  --
--  宽度x高度=128x64  --*/

0x10,0xD0,0x3C,0x90,0x7C,0x10,0x00,0x00,0x00,0x08,0xFC,0x00,0x00,0x00,0x00,0xF8,
0x04,0x04,0x04,0xF8,0x00,0x00,0x00,0x60,0x60,0x00,0x00,0x00,0x00,0xFC,0x44,0x44,
0x44,0xFF,0x44,0x44,0x44,0x44,0xFC,0x00,0x00,0x10,0x08,0x7C,0x03,0x10,0x90,0x3F,
0x48,0x44,0x44,0x42,0x70,0x00,0x00,0x00,0x00,0x00,0xC0,0x3F,0xC0,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0xFF,0x49,0x49,0x49,0x79,0xC9,0x49,0x49,0x4F,0x40,0x40,0x00,
0x80,0x84,0x84,0x84,0xFF,0x84,0x84,0x84,0xFF,0x84,0x84,0x80,0x00,0x10,0x92,0x52,
0xFE,0x51,0x91,0x10,0xFC,0x04,0x04,0xFC,0x00,0x00,0x00,0xFF,0x01,0x25,0x25,0xFD,
0x25,0x65,0xA5,0x01,0xFF,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x01,0x07,0x01,0x07,0x01,0x01,0x00,0x00,0x00,0x04,0x07,0x04,0x00,0x00,0x00,0x03,
0x04,0x04,0x04,0x03,0x00,0x00,0x00,0x06,0x06,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x0F,0x00,0x00,0x00,0x00,0x00,0xC0,0x00,0x01,0x01,0x01,0x01,0x01,0x0F,0x01,
0x01,0x01,0x01,0x01,0xC1,0x80,0x08,0x04,0xC2,0x01,0x00,0x00,0x80,0x01,0x02,0x04,
0x0C,0x04,0x00,0x00,0x0F,0x08,0x04,0xC2,0x80,0x01,0x02,0x04,0x08,0x08,0x0E,0x00,
0x00,0x08,0x84,0x82,0x81,0x80,0x80,0x81,0x82,0x84,0x88,0x80,0x00,0x02,0x01,0x00,
0x0F,0x00,0x00,0x00,0x07,0x82,0x02,0x03,0x00,0x00,0x80,0x0F,0x05,0x05,0x05,0x05,
0x05,0x05,0x05,0x05,0x0F,0x80,0x80,0x80,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x10,0xF0,0x1E,0x10,0xF0,0x1E,0x10,0x00,0x00,0x04,0x04,0xFE,0x00,0x00,0x00,0x00,
0x00,0x1C,0x02,0x02,0x82,0x62,0x1C,0x00,0x00,0x00,0x00,0x30,0x30,0x00,0x00,0x00,
0x00,0x00,0xFF,0x82,0x82,0x82,0x82,0xFF,0x82,0x82,0x82,0x82,0xFF,0x02,0x00,0x00,
0x08,0x04,0x02,0x7F,0x00,0x00,0x04,0xC4,0x1F,0x22,0x22,0x21,0x21,0x39,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0xC0,0x30,0x0F,0x70,0x80,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0xFF,0x24,0x24,0x24,0x24,0x3C,0xE4,0x24,0x24,0x27,0x20,0x20,0x00,0x00,
0x80,0x84,0x84,0x84,0x84,0xFF,0x84,0x84,0x84,0x84,0xFF,0x84,0x84,0x84,0x80,0x00,
0x00,0x09,0x89,0x69,0xFF,0x48,0x88,0x08,0x00,0xFE,0x02,0x02,0x02,0xFE,0x00,0x00,
0x01,0x0F,0x01,0x01,0x0F,0x01,0x01,0x00,0x00,0x08,0x08,0x0F,0x08,0x08,0x00,0x00,
0x00,0x0C,0x0A,0x09,0x08,0x08,0x0C,0x00,0x00,0x00,0x00,0x0C,0x0C,0x00,0x00,0x00,
0x00,0x00,0x01,0x00,0x00,0x00,0x00,0x3F,0x00,0x00,0x00,0x00,0x01,0x00,0x00,0x00,
0x80,0x01,0x01,0x01,0x01,0x01,0x01,0x3F,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x80,
0x80,0x10,0x08,0x04,0x83,0x00,0x00,0x00,0x00,0x01,0x03,0x06,0x0C,0x18,0x08,0x00,
0x00,0x00,0x3F,0x10,0x08,0x84,0x80,0x00,0x00,0x03,0x04,0x08,0x10,0x3C,0x00,0x00,
0x00,0x00,0x20,0x10,0x0C,0x07,0x02,0x00,0x00,0x01,0x02,0x0C,0x38,0x10,0x80,0x00,
0x04,0x02,0x01,0x00,0x3F,0x00,0x03,0x01,0x00,0x0F,0x04,0x04,0x04,0x0F,0x00,0x00,
0x10,0x90,0xFE,0x10,0x10,0x90,0xFE,0x10,0x00,0x00,0x00,0x04,0x04,0xFE,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0xC0,0x30,0x08,0x04,0xFE,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x60,0x60,0x00,0x00,0x00,0x00,0x00,0x00,0x04,0xF8,0x08,0x08,0x08,0x08,0x08,
0xFF,0x08,0x08,0x08,0x08,0x08,0xFC,0x00,0x00,0x00,0x00,0x20,0x10,0x08,0xFE,0x05,
0x00,0x20,0x20,0x10,0xFF,0x88,0x88,0x84,0x82,0x83,0xE0,0x80,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x80,0xFF,0x1F,0xE0,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0xFF,0x91,0x91,0x91,0x91,0x91,0xF1,0x91,0x91,0x91,0x91,0x9F,0x80,
0xC0,0x80,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x04,0x3F,0x04,0x04,0x04,0x3F,0x04,0x04,0x00,0x00,0x00,0x20,0x20,0x3F,0x20,0x20,
0x00,0x00,0x00,0x00,0x03,0x02,0x02,0x22,0x22,0x3F,0x22,0x22,0x00,0x00,0x00,0x00,
0x00,0x30,0x30,0x00,0x00,0x00,0x00,0x00,0x00,0x02,0x01,0x01,0x01,0x01,0x01,0x01,
0xFF,0x01,0x01,0x01,0x01,0x01,0x03,0x00,0x00,0x00,0x00,0x00,0x08,0x08,0x09,0x08,
0x08,0x08,0x08,0xFF,0x08,0x08,0x08,0x08,0x08,0x08,0x04,0x04,0x00,0x00,0x80,0x40,
0x40,0x20,0x10,0x0C,0x03,0x00,0x00,0x00,0x03,0x0C,0x18,0x30,0x60,0x60,0x00,0x00,
0x00,0x00,0x00,0x7F,0x60,0x20,0x20,0x10,0x00,0x01,0x06,0x18,0x30,0x60,0x40,0x40,
0xF0,0x80,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x80,0x40,0x20,0x20,0x40,0x80,0x00,0x20,0xE0,0x20,0x00,
0x00,0x00,0x00,0x20,0xE0,0x20,0x20,0x20,0x60,0x00,0x20,0xE0,0x20,0x20,0x40,0x80,
0x00,0x00,0xE0,0x20,0x20,0x20,0xF8,0x20,0x20,0x20,0x20,0xE0,0x00,0x00,0x20,0x20,
0x20,0xE0,0x20,0x28,0x30,0x20,0xE0,0x20,0x20,0x20,0x00,0x00,0x00,0xF0,0x50,0x50,
0x50,0x50,0x50,0x50,0xF8,0x10,0x00,0x00,0x00,0x80,0x90,0x90,0x90,0x90,0x90,0x90,
0x90,0x98,0xD0,0x80,0x00,0x20,0x20,0xE8,0x30,0x60,0xA0,0x80,0x60,0x58,0x40,0xC0,
0x40,0x00,0x00,0x00,0xF8,0x28,0x28,0x28,0xF8,0x28,0x28,0xF8,0x00,0x00,0x00,0x00,
0x00,0x80,0xC0,0x60,0xF8,0xF8,0x60,0xC0,0x80,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x0F,0x10,0x20,0x20,0x10,0x0F,0x00,0x20,0x3F,0x20,0x20,
0x20,0x30,0x00,0x20,0x3F,0x22,0x22,0x27,0x30,0x00,0x20,0x3F,0x20,0x20,0x10,0x0F,
0x00,0x00,0x07,0x02,0x02,0x02,0x7F,0x02,0x02,0x02,0x02,0x07,0x00,0x00,0x40,0x40,
0x40,0x20,0x23,0x14,0x08,0x16,0x21,0x20,0x40,0x40,0x00,0x40,0x44,0x49,0x51,0x7F,
0x41,0x41,0x7F,0x51,0x49,0x64,0x40,0x00,0x20,0x10,0x08,0x06,0x00,0x40,0x7F,0x00,
0x02,0x04,0x08,0x30,0x00,0x42,0x21,0x12,0x0C,0x13,0x20,0x40,0x27,0x18,0x14,0x23,
0x40,0x00,0x44,0x44,0x25,0x15,0x0D,0x05,0x7F,0x0D,0x15,0x25,0x64,0x24,0x00,0x00,
0x03,0x01,0x00,0x00,0xFF,0xFF,0x00,0x00,0x01,0x03,0x00,0x00,0x00,0x00,0x00,0x00
};


//  Delay Time
//-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

void 	delay_ms(Uint t)
{
	Uchar i,j;
	while(--t)
	{
	i=50;	
	j=100;

		while(--j)
			while(--i);
	}
}
void uDelay(Uchar l)
{
	while(l--);
}


void Delay(Uchar n)
{
Uchar i,j,k;

	for(k=0;k<n;k++)
	{
		for(i=0;i<131;i++)
		{
			for(j=0;j<15;j++)
			{
				uDelay(203);	
			}
		}
	}
}


//-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
//6800

//-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
/*
void write_command(Uchar Data)
{

        CS=0;

        RS=0;
		WR=0;


		RD=1;//E
		PORT=Data;
		delay(2);
		RD=0;//E
		delay(2);
        CS0=1;




void Write_Data(Uchar Data)
{
        CS=0;

        RS=1;

        WR=0;

		RD=1;//E
		PORT=Data;
		delay(2);
		RD=0;//E
		delay(2);

       CS0=1;

}
*/
//**********************************************************


//8080
//**********************************************************
void Write_Command(Uchar Data)
{
RD=1;
RS=0;
CS=0;
PORT=Data;
WR=0;
_nop_();
WR=1;
CS=1;
}

void Write_Data(Uchar Data)
{
RD=1;
RS=1;
CS=0;
PORT=Data;
WR=0;
_nop_();
WR=0;
CS=1;
}
/*
//*********************************************************************
//  Read/Write Sequence_i2C
//-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
void I2C_O(Uchar mcmd)
{
Uchar length = 8;			// Send Command

	while(length--)
	{
		if(mcmd & 0x80)
		{
			SDA=1;
		}
		else
		{
			SDA=0;
		}
//		uDelay(3);
		SCL=1;
//		uDelay(3);
		SCL=0;
//		uDelay(3);
		mcmd = mcmd << 1;
	}
}


void I2C_Ack()
{
	SDA=1;
//	uDelay(3);
	SCL=1;
//	uDelay(3);
	SCL=0;
//	uDelay(3);
}


void I2C_NAck()
{
	SDA=0;
//	uDelay(3);
	SCL=1;
//	uDelay(3);
	SCL=0;
//	uDelay(3);
}


void I2C_Start()
{
	SDA=0;
//	uDelay(3);
	SCL=1;
//	uDelay(3);
	SCL=0;
//	uDelay(3);
	I2C_O(0x78);
	I2C_Ack();
}


void I2C_Stop()
{
	SCL=1;
//	uDelay(5);
	SDA=0;
//	uDelay(5);
	SDA=1;
//	uDelay(5);
}


void Write_Command(Uchar Data)
{
	I2C_Start();
	I2C_O(0x00);
	I2C_Ack();
	I2C_O(Data);
	I2C_Ack();
	I2C_Stop();
}


void Write_Data(Uchar Data)
{
	I2C_Start();
	I2C_O(0x40);
	I2C_Ack();
	I2C_O(Data);
	I2C_Ack();
	I2C_Stop();
}

//****************************************************************************
//-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

}
*/
void	LCD_Init(void)
{
RES=0;
uDelay(20);
RES=1;
//internal setting


Write_Command(0xae);	//--turn off oled panel
Write_Command(0x00);	//--set low column address
Write_Command(0x10);	//--set high column address
Write_Command(0x40);	//--set start line address
Write_Command(0x81);	//--set contrast control register
Write_Command(0xf0);

Write_Command(0xa0);	//--set segment re-map a0--0 to 127    a1---127to 0

Write_Command(0xa6);	//--set normal display

Write_Command(0xc0);	//--set com(N-1)to com0  c0:com0 to com(N-1)

Write_Command(0xa8);	//--set multiples ratio(1to64)
Write_Command(0x3f);	//--1/64 duty
Write_Command(0xd3);	//--set display offset
Write_Command(0x00);	//--not offset
Write_Command(0xd5);	//--set display clock divide ratio/oscillator frequency
Write_Command(0x80);	//--set divide ratio
Write_Command(0xd9);	//--set pre-charge period
Write_Command(0xf1);
Write_Command(0xda);	//--set com pins hardware configuration
Write_Command(0x12);
Write_Command(0xdb);	//--set vcomh
Write_Command(0x30);
Write_Command(0x8d);	//--set chare pump enable/disable
Write_Command(0x14);	//--set(0x10) disable
//Write_Command(0xaf);	//--turn on oled panel
/*
Write_Command(0xae);	//--turn off oled panel
Write_Command(0x00);	//--set low column address
Write_Command(0x10);	//--set high column address
Write_Command(0x40);	//--set start line address
Write_Command(0x81);	//--set contrast control register
Write_Command(0x8f);
Write_Command(0xa1);	//--set segment re-map 95 to 0
Write_Command(0xa6);	//--set normal display
Write_Command(0xa8);	//--set multiples ratio(1to64)
Write_Command(0x3f);	//--1/64 duty
Write_Command(0xd3);	//--set display offset
Write_Command(0x00);	//--not offset
Write_Command(0xd5);	//--set display clock divide ratio/oscillator frequency
Write_Command(0x80);	//--set divide ratio
Write_Command(0xd9);	//--set pre-charge period
Write_Command(0x22);
Write_Command(0xda);	//--set com pins hardware configuration
Write_Command(0x12);
Write_Command(0xdb);	//--set vcomh
Write_Command(0x30);
Write_Command(0x8d);	//--set chare pump enable/disable
Write_Command(0x10);	//--set(0x14) enable
Write_Command(0xaf);	//--turn on oled panel
*/

}
//-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

void clr_display(void)
{
	Uchar i,j;
	for(j=0;j<8;j++)
	{
		Write_Command(0x22);//--set page1
		Write_Command(j);//--set start page
		Write_Command(0x07);//--set start page
 		for(i=0;i<128;i++)		  				//显示单色数据到LCD
		{
			Write_Data(0x00);
		}
	}
}
		
//-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
//-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
void pic1(void)
{
	Uchar i,j;
	Uint k;
	k=0;
	for(j=0;j<8;j++)
	{
		Write_Command(0x22);//--set page1
		Write_Command(j);//--set start page
		Write_Command(0x07);//--set end page

 		for(i=0;i<128;i++)		  				//显示单色数据到LCD
		{
			Write_Data(color[k]);
			k=k+1;
		
		}
	}
}
//-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

			
//-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
//-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
void pic2(void)
{
	Uchar i,j;
	Uint k;
	k=0;
	for(j=0;j<8;j++)
	{
		Write_Command(0x22);//--set page1
		Write_Command(j);//--set start page
		Write_Command(0x07);//--set end page

 		for(i=0;i<128;i++)		  				//显示单色数据到LCD
		{
			Write_Data(color1[k]);
			k=k+1;
		
		}
	}
}
//-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=



void pic3(void)
{
	Uchar i,j;
	Uint k;
	k=0;
	for(j=0;j<8;j++)
	{
		Write_Command(0x22);//--set page1
		Write_Command(j);//--set start page
		Write_Command(0x07);//--set end page

 		for(i=0;i<128;i++)		  				//显示单色数据到LCD
		{
			Write_Data(color2[k]);
			k=k+1;
		
		}
	}
}
	
//-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

void pic4(void)
{
	Uchar i,j;
	Uint k;
	k=0;
	for(j=6;j<8;j++)
	{
		Write_Command(0x22);//--set page1
		Write_Command(j);//--set start page
		Write_Command(0x07);//--set end page

 		for(i=0;i<128;i++)		  				//显示单色数据到LCD
		{
			Write_Data(color3[k]);
			k=k+1;
		
		}
	}
}
	
//-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
void main()
{


	BS0=0;
	BS1=1;
	BS2=1;

//8080 8BIT
	uDelay(10);


	LCD_Init();

	clr_display();

	Write_Command(0xaf);	//--turn on oled panel

	while(1)

	{
		pic1();
		delay_ms(30);
		Write_Command(0xa7);	//--set normal display
		delay_ms(30);

		Write_Command(0xa6);	//--set normal display
		pic2();
		delay_ms(20);
		Write_Command(0xa7);	//--set normal display
		delay_ms(20);

		Write_Command(0xa6);	//--set normal display
		pic3();
		delay_ms(20);
		Write_Command(0xa7);	//--set normal display
		delay_ms(20);

		Write_Command(0xa6);	//--set normal display
		pic4();
		delay_ms(20);
		Write_Command(0xa7);	//--set normal display
		delay_ms(20);

		Write_Command(0xa6);	//--set normal display


//		while(1);
	}

}
